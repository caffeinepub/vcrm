{
  "kind": "build_request",
  "title": "Fix Profile Setup modal 'Unable to save profile' error",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the backend `saveCallerUserProfile` function to correctly accept and store name, email, and phone fields. Ensure the Candid type signature matches what the frontend sends, and that the function returns a success result without throwing or returning an error variant.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Unable to save profile. Please try again."
        ]
      },
      "acceptanceCriteria": [
        "Calling saveCallerUserProfile with valid name, email, and phone values persists the profile in stable storage",
        "The function returns a #ok result variant on success",
        "No trap or error is thrown for valid inputs"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Fix the ProfileSetupModal component to correctly invoke the backend actor's `saveCallerUserProfile` function. Ensure the actor reference is fresh (not stale), argument types match the current Candid interface, and all error cases surface a meaningful message. On success, dismiss the modal and proceed to the dashboard.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Unable to save profile. Please try again."
        ]
      },
      "acceptanceCriteria": [
        "Submitting the profile form with name, email, and phone successfully saves the profile and closes the modal",
        "The user is redirected to the dashboard after a successful save",
        "If the backend returns an error, the error message is displayed clearly inside the modal",
        "The actor used in the mutation is always the latest authenticated instance"
      ]
    }
  ],
  "constraints": [
    "Do not modify files under frontend/src/hooks/useInternetIdentity.ts or frontend/src/hooks/useActor.ts",
    "Do not change the overall OTP login flow â€” only fix the profile save path"
  ],
  "nonGoals": [
    "Redesigning the Profile Setup modal UI",
    "Adding new profile fields beyond name, email, and phone",
    "Changing the authentication mechanism"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}